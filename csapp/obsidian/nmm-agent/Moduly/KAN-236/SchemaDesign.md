#### 앱(App)과 워크플로우(Workflow)의 관계

## 1. 구조적 특징 (1:N)


- **앱 (App)**: 애플리케이션의 껍데기이자 식별자(Identity)입니다. 이름, 아이콘, 기본 설정 등을 담고 있습니다.
- **워크플로우 (Workflow)**: 앱이 실제로 동작하는 로직(그래프, 노드, 엣지)과 변수 설정의 **스냅샷**입니다.
- **관계**: 하나의 앱 ID(`app_id`)에 연결된 워크플로우 데이터가 `workflows` 테이블에 여러 개 존재합니다.

## 2. 왜 1:N 구조를 가지는가?

이 구조가 필요한 핵심적인 이유는 **버전 관리(Versioning)**와 **환경 분리** 때문입니다.

### 2.1. 초안(Draft)과 배포(Published)의 완벽한 분리

- **Draft 버전**: 개발자가 캔버스에서 수정하고 있는 작업용 버전입니다.
- **Published 버전**: 실제 사용자가 앱을 실행할 때 사용하는 배포된 버전입니다.
- **효과**: 개발자가 로직을 대대적으로 수정하거나 테스트하는 중에도, 이미 배포된 서비스를 사용하는 사용자들에게는 아무런 영향을 주지 않습니다.

### 2.2. 이력 관리 및 롤백 (History & Rollback)

- **스냅샷 저장**: 앱을 "게시(Publish)"할 때마다 새로운 워크플로우 행(Record)이 생성됩니다 (예: `v1`, `v2`, `2024-01-01 버전`).
- **안전망**: 만약 새로 배포한 로직에 치명적인 오류가 있다면, 언제든지 과거의 정상 작동하던 워크플로우 버전으로 앱을 되돌릴 수 있습니다.

## 3. 데이터베이스 관점 (Schema)

- **`apps` 테이블**: 앱의 메타데이터를 저장하며, 현재 활성화된(사용자가 쓰는) 워크플로우를 가리키는 `workflow_id`를 가집니다.
- **`workflows` 테이블**:
  - `app_id`: 소속된 앱을 가리키는 Foreign Key 역할.
  - `version`: `draft`(초안) 또는 구체적인 버전 식별자.
  - `graph`: 해당 시점의 노드와 연결 구조를 담은 JSON 데이터.

